<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PocketBase to OpenAPI Converter | Enhanced</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">

</head>
<body>
    <div class="container">
        <header>
            <h1>
                <i class="fas fa-sync-alt"></i>
                PocketBase to OpenAPI Converter
            </h1>
            <p class="subtitle">Convert your PocketBase schemas to OpenAPI specifications with collection grouping and export control</p>
            
            <div class="features">
                <div class="feature">
                    <i class="fas fa-layer-group"></i>
                    <h3>Grouped by Collection</h3>
                    <p>API endpoints grouped by collection in the final Swagger output</p>
                </div>
                <div class="feature">
                    <i class="fas fa-edit"></i>
                    <h3>Title Customization</h3>
                    <p>Set custom titles for each collection in the OpenAPI spec</p>
                </div>
                <div class="feature">
                    <i class="fas fa-check-square"></i>
                    <h3>Selective Export</h3>
                    <p>Choose exactly which collections to include in the final export</p>
                </div>
                <div class="feature">
                    <i class="fas fa-lock"></i>
                    <h3>Secure Processing</h3>
                    <p>All processing happens in your browser - your data never leaves your device</p>
                </div>
            </div>
        </header>

        <div class="flex-container">
            <div class="flex-item">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-file-import"></i>
                        Upload PocketBase Schema
                    </h2>
                    
                    <div class="input-group">
                        <label for="schemaFile">Select PocketBase Schema JSON File</label>
                        <input type="file" id="schemaFile" accept=".json" class="file-input">
                        <label for="schemaFile" class="file-label" id="fileDropArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drag & drop your PocketBase schema file here<br>or click to browse</p>
                            <div class="file-name" id="fileName">No file selected</div>
                        </label>
                    </div>
                    
                    <div id="collectionManagement" class="collection-management" style="display: none;">
                        <div class="collection-header">
                            <h3><i class="fas fa-sliders-h"></i> Collection Management</h3>
                            <div class="collection-controls">
                                <button id="selectAllBtn" class="btn btn-secondary">
                                    <i class="fas fa-check-circle"></i> Select All
                                </button>
                                <button id="deselectAllBtn" class="btn btn-secondary">
                                    <i class="fas fa-times-circle"></i> Deselect All
                                </button>
                            </div>
                        </div>
                        
                        <div class="collections-list" id="collectionsList"></div>
                    </div>
                    
                    <div class="expand-control">
                        <div class="expand-title">
                            <i class="fas fa-expand-alt"></i>
                            <h3>Expansion Configuration</h3>
                        </div>
                        <p>Configure how relations should be expanded in the generated OpenAPI spec</p>
                        
                        <div class="expand-options">
                            <div class="option">
                                <label>
                                    <input type="checkbox" id="enableExpansion" checked>
                                    Enable relation expansion
                                </label>
                                <p class="small">Add expand parameters to API endpoints</p>
                            </div>
                            <div class="option">
                                <label>
                                    <input type="checkbox" id="deepExpansion" checked>
                                    Enable deep expansion
                                </label>
                                <p class="small">Allow nested relations using dot notation</p>
                            </div>
                            <div class="option">
                                <label>
                                    <input type="checkbox" id="setDefaultExpansion" checked>
                                    Set default expansion paths
                                </label>
                                <p class="small">Include expansion in all generated specs</p>
                            </div>
                        </div>
                    </div>
                    
                    <button id="processBtn" class="btn btn-large btn-block">
                        <i class="fas fa-cogs"></i> Generate OpenAPI Specification
                    </button>
                    
                    <div id="statusMessage" class="status"></div>
                    
                    <div id="previewSection" style="display: none;">
                        <div style="margin-top: 25px; text-align: center;">
                            <button id="downloadBtn" class="btn btn-success btn-large">
                                <i class="fas fa-download"></i> Download OpenAPI Spec
                            </button>
                            <button id="copyBtn" class="btn btn-secondary btn-large">
                                <i class="fas fa-copy"></i> Copy to Clipboard
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex-item">
                <div class="card">
                    <div class="tab-container">
                        <div class="tab active" data-tab="preview">Spec Preview</div>
                        <div class="tab" data-tab="collections">Collections</div>
                        <div class="tab" data-tab="documentation">Documentation</div>
                    </div>
                    
                    <div class="tab-content active" id="previewTab">
                        <h2 class="card-title">
                            <i class="fas fa-file-code"></i>
                            OpenAPI Specification
                        </h2>
                        
                        <div class="preview-container">
                            <button id="copySpecBtn" class="btn copy-btn">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <textarea id="outputPreview" placeholder="Your OpenAPI specification will appear here..."></textarea>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="collectionsTab">
                        <h2 class="card-title">
                            <i class="fas fa-project-diagram"></i>
                            Detected Relations
                        </h2>
                        <div class="expandable-paths" id="expandablePaths"></div>
                        
                        <div class="expand-control">
                            <h3>Default Expansion Paths</h3>
                            <p>These paths will be included by default in all generated specs</p>
                            
                            <div id="defaultExpansionContainer" style="margin-top: 15px;">
                                <div class="input-group">
                                    <label for="defaultExpansion">Comma-separated expansion paths:</label>
                                    <input type="text" id="defaultExpansion" class="btn-block" 
                                           placeholder="author, comments.user, categories" 
                                           style="padding: 12px; border: 1px solid #ddd; border-radius: var(--border-radius);">
                                </div>
                                
                                <div style="margin: 15px 0;">
                                    <h4>Detected Relations:</h4>
                                    <div id="detectedRelations" class="expandable-paths"></div>
                                </div>
                                
                                <button id="saveDefaultsBtn" class="btn btn-secondary">
                                    <i class="fas fa-save"></i> Save as Default
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="documentationTab">
                        <h2 class="card-title">
                            <i class="fas fa-book"></i>
                            Documentation
                        </h2>
                        
                        <div class="expand-control">
                            <h3>Collection Grouping in OpenAPI</h3>
                            <p>This converter groups API endpoints by collection using OpenAPI tags.</p>
                            
                            <div class="expand-preview">
                                <p><strong>Example Output:</strong></p>
                                <pre>paths:
  /collections/posts/records:
    get:
      tags: ["Posts"]
      ...
  /collections/posts/records/{id}:
    get:
      tags: ["Posts"]
      ...</pre>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <h3>Selective Collection Export</h3>
                                <p>You can choose which collections to include in the final OpenAPI export:</p>
                                <ul style="padding-left: 20px; margin: 10px 0;">
                                    <li>Select/deselect individual collections using checkboxes</li>
                                    <li>Use "Select All" or "Deselect All" for bulk operations</li>
                                    <li>Only selected collections will be included in the final spec</li>
                                </ul>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <h3>Title Customization</h3>
                                <p>For each collection, you can set a custom title that will appear:</p>
                                <ul style="padding-left: 20px; margin: 10px 0;">
                                    <li>As the tag name in the OpenAPI documentation</li>
                                    <li>In endpoint summaries and descriptions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>This tool converts PocketBase collection schemas to OpenAPI 3.0 specifications with collection grouping. No data is sent to any server - processing happens entirely in your browser.</p>
            <p>© 2025 PocketBase to OpenAPI Converter | Made with ❤️ by a mobile developer exploring web technologies</p>
        </div>
    </div>


</body>
</html>
